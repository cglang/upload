import{_ as g,a as c,l as u,c as i,w as _,v as m,b as e,e as x,F as f,r as b,o as l,j as w,t as d,f as v,d as k,p as y,i as $}from"./index-2461a6dc.js";import{h}from"./moment-8e448131.js";const M={data(){return{pastes:[],title:"",text:""}},methods:{getFromNow(t){return h(t).fromNow()},calcExpiredDate(t){if(t!=0){if(t==-1)return-1;var o=h(new Date).add(t,"m").toDate();return h(o).format("YYYY-MM-DD HH:mm:ss")}},list(){this.$root.loading=!0,c.post("/paste/list").then(t=>{t.success?this.pastes=t.detail:this.$root.showModal("失败",t.msg)}).catch(t=>{this.$root.showModal("错误",t.message)}).finally(()=>{this.$root.loading=!1})},add(){if(this.text.trim().length===0){this.$root.showModal("提示","正文不能为空");return}this.$root.loading=!0,c.post("/paste/add",u.stringify({title:this.title.trim().length===0?"未命名":this.title,text:this.text,expiredDate:this.calcExpiredDate(this.$refs.select.value),isPrivate:this.$refs.isPrivate.checked})).then(t=>{t.success?(this.list(),this.$root.showModal("发布成功",location.protocol+"//"+location.host+"/pastes/"+t.detail.id),this.text="",this.title=""):this.$root.showModal("失败",t.msg)}).catch(t=>{this.$root.showModal("错误",t.message)}).finally(()=>{this.$root.loading=!1})},remove(t){this.$root.hasToken(()=>this.remove(t))&&(this.$root.loading=!0,c.post("/paste/delete",u.stringify({id:t})).then(o=>{o.success?(this.$root.showModal("成功","删除成功"),this.list()):this.$root.showModal("失败",o.msg)}).catch(o=>{this.$root.showModal("错误",o.message)}).finally(()=>{this.$root.loading=!1}))}},created(){this.list()}},r=t=>(y("data-v-b41e037f"),t=t(),$(),t),D={class:"float-end mb-3 row g-3 align-middle"},C={class:"col-auto"},N={class:"form-check form-switch",style:{padding:"0.375rem 0.75rem"}},P={class:"form-check-input",type:"checkbox",role:"switch",id:"isPrivate",ref:"isPrivate"},T=r(()=>e("label",{class:"form-check-label",for:"isPrivate"},"私密",-1)),V={class:"col-auto"},E={class:"form-select mb-2",ref:"select"},F=["selected"],I=r(()=>e("option",{value:"60"},"1小时",-1)),S=r(()=>e("option",{value:"1440"},"1天",-1)),Y=r(()=>e("option",{value:"10080"},"1周",-1)),B=r(()=>e("option",{value:"-1"},"阅后即焚",-1)),j=["selected"],H={class:"col-auto"},K={class:"list-group clear-both"},U=["onClick"],z={class:"float-end"},A=["data-clipboard-text"],L=["onClick"],O={class:"text-primary text-truncate mw-75"},q={class:"text-truncate mw-75"},G={class:"text-muted mb-0"},J={key:0,class:"text-danger",style:{"font-size":"0.875rem"}},Q={key:0},R={key:1};function W(t,o,X,Z,a,n){return l(),i(f,null,[_(e("input",{class:"form-control mb-2",placeholder:"标题","onUpdate:modelValue":o[0]||(o[0]=s=>a.title=s)},null,512),[[m,a.title]]),_(e("textarea",{class:"form-control mb-3",rows:"10",placeholder:"正文","onUpdate:modelValue":o[1]||(o[1]=s=>a.text=s),onKeyup:o[2]||(o[2]=x(w(s=>n.add(),["ctrl"]),["enter"]))},null,544),[[m,a.text]]),e("div",D,[e("div",C,[e("div",N,[e("input",P,null,512),T])]),e("div",V,[e("select",E,[e("option",{value:"10",selected:t.$root.noToken()},"10分钟",8,F),I,S,Y,B,e("option",{value:"0",selected:!t.$root.noToken()},"永不过期",8,j)],512)]),e("div",H,[e("button",{class:"btn btn-outline-primary mb-2 col-auto",onClick:o[3]||(o[3]=s=>n.add())}," 发布 ")])]),e("ul",K,[(l(!0),i(f,null,b(a.pastes,s=>(l(),i("li",{class:"list-group-item list-group-item-action cursor-pointer",key:s,onClick:p=>p.target.tagName!=="A"&&t.$router.push("/pastes/"+s.id)},[e("div",z,[e("a",{class:"link-primary bi bi-clipboard",id:"btnCopy","data-clipboard-text":s.text},null,8,A),e("a",{class:"link-danger bi bi-trash ms-1",onClick:p=>t.$root.showConfirm(()=>n.remove(s.id))},null,8,L)]),e("div",null,[e("p",O,d(s.title),1),e("p",q,[e("i",null,d(s.text),1)]),e("p",G,[v(" 发布于 "+d(s.time.slice(0,-3))+" ",1),s.expiredDate?(l(),i("span",J,[v("   "),s.expiredDate==-1?(l(),i("span",Q,"阅后即焚")):(l(),i("span",R,"Expired "+d(n.getFromNow(s.expiredDate)),1))])):k("",!0)])])],8,U))),128))])],64)}const st=g(M,[["render",W],["__scopeId","data-v-b41e037f"]]);export{st as default};
