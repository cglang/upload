!function(){function t(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,o){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var i,r,e,a,l=[],s=!0,u=!1;try{if(e=(n=n.call(t)).next,0===o){if(Object(n)!==n)return;s=!1}else for(;!(s=(i=e.call(n)).done)&&(l.push(i.value),l.length!==o);s=!0);}catch(d){u=!0,r=d}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw r}}return l}}(t,n)||function(t,n){if(!t)return;if("string"==typeof t)return o(t,n);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return o(t,n)}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,o){(null==o||o>t.length)&&(o=t.length);for(var n=0,i=new Array(o);n<o;n++)i[n]=t[n];return i}System.register(["./index-legacy-c88ad1d1.js","./FileSaver.min-legacy-c8ad37b8.js"],(function(o,n){"use strict";var i,r,e,a,l,s,u,d,c,f,h,g,m,b,p,y=document.createElement("style");return y.textContent=".icon[data-v-277ede0b]{width:auto;height:15px;margin-right:10px;vertical-align:middle}.custom-btn-group :not(:first-child):not(:last-child) .btn[data-v-277ede0b]{border-radius:0!important;border-left:0!important}.custom-btn-group :first-child .btn[data-v-277ede0b]{border-top-right-radius:0;border-bottom-right-radius:0}.custom-btn-group :last-child .btn[data-v-277ede0b]{border-left:0!important;border-top-left-radius:0;border-bottom-left-radius:0}@media screen and (max-width: 768px){.url[data-v-277ede0b]{display:none}}\n",document.head.appendChild(y),{setters:[function(t){i=t._,r=t.a,e=t.l,a=t.c,l=t.b,s=t.F,u=t.r,d=t.w,c=t.v,f=t.e,h=t.o,g=t.h,m=t.t,b=t.p,p=t.i},null],execute:function(){var n={data:function(){return{bookmarks:{},url:"",tags:"",currentTags:[]}},methods:{isJSON:function(t){try{return JSON.parse(t)&&!!t}catch(o){return!1}},extractDomain:function(t){try{return new URL(t).hostname}catch(o){return null}},list:function(){var t=this;0==this.currentTags.length?(this.$root.loading=!0,r.post("bookmark/list").then((function(o){o.success?t.bookmarks=o.detail:t.$root.showModal("失败",o.msg)})).catch((function(o){t.$root.showModal("错误",o.message)})).finally((function(){t.$root.loading=!1}))):this.findByTags()},add:function(){var t=this;0!==this.url.trim().length?(this.$root.loading=!0,r.post("bookmark/add",e.stringify({url:this.url})).then((function(o){o.success?(t.list(),t.addTags(o.detail),t.update(o.detail)):t.$root.showModal("添加失败",o.msg)})).catch((function(o){t.$root.showModal("错误",o.message)})).finally((function(){t.url="",t.$root.loading=!1}))):this.$root.showModal("提示","URL不能为空")},remove:function(t){var o=this;this.$root.hasToken((function(){return o.remove(t)}))&&(this.$root.loading=!0,r.post("bookmark/delete",e.stringify({id:t})).then((function(t){t.success?(o.$root.showModal("成功","删除成功"),o.list()):o.$root.showModal("失败","删除失败")})).catch((function(t){o.$root.showModal("错误",t.message)})).finally((function(){o.$root.loading=!1})))},rename:function(t){var o=this;0!==this.$root.$refs.input.value.trim().length?(this.$root.loading=!0,r.post("bookmark/rename",e.stringify({id:t,title:this.$root.$refs.input.value})).then((function(t){t.success?(o.$root.showModal("成功","修改成功"),o.list()):o.$root.showModal("失败","修改失败")})).catch((function(t){o.$root.showModal("错误",t.message)})).finally((function(){o.$root.loading=!1}))):this.$root.showModal("提示","标题不能为空")},update:function(t){var o=this;this.$root.loading=!0,r.post("bookmark/update",e.stringify({id:t})).then((function(t){t.success?(o.$root.showModal("成功","更新成功"),o.list()):o.$root.showModal("失败","更新失败")})).catch((function(t){o.$root.showModal("错误",t.message)})).finally((function(){o.$root.loading=!1}))},addTags:function(t){var o=this;this.$root.loading=!0,r.post("bookmark/addTags",e.stringify({bookmarkId:t,tagIds:this.currentTags.join(",")})).then((function(t){t.success||console.log("添加标签失败："+t.msg)})).catch((function(t){console.log("添加标签失败："+t.message)})).finally((function(){o.$root.loading=!1}))},importBookmarks:function(t){var o=this;this.$root.loading=!0;var n=new FileReader;n.readAsText(t.target.files[0]),n.onload=function(t){var n=t.target.result;if(!o.isJSON(n))return o.$root.showModal("错误","不是合法的json数据"),void(o.$root.loading=!1);r.post("bookmark/bulkAdd",e.stringify({data:n})).then((function(t){t.success?(o.list(),o.$root.showModal("成功",t.msg)):o.$root.showModal("失败",t.msg)})).catch((function(t){o.$root.showModal("错误",t.message)})).finally((function(){o.$root.loading=!1}))}},exportBookmarks:function(){this.$root.loading=!0;for(var o=[],n=0,i=Object.entries(this.bookmarks);n<i.length;n++){var r=t(i[n],2),e=(r[0],r[1]),a=new Object;a.title=e.title,a.url=e.url,o.push(a)}var l=JSON.stringify(o,null,2),s=new Blob([l],{type:"text/plain;charset=utf-8"});saveAs(s,"bookmarks.json"),this.$root.loading=!1},updateAll:function(){var t=this;this.$root.loading=!0,r.post("bookmark/updateAll").then((function(o){o.success?(t.list(),t.$root.showModal("成功",o.msg)):t.$root.showModal("失败",o.msg)})).catch((function(o){t.$root.showModal("错误",o.message)})).finally((function(){t.$root.loading=!1}))},listTags:function(){var t=this;this.$root.loading=!0,r.post("bookmark/findAllTags").then((function(o){o.success?t.tags=o.detail:t.$root.showModal("失败",o.msg)})).catch((function(o){t.$root.showModal("错误",o.message)})).finally((function(){t.$root.loading=!1}))},findByTags:function(){var t=this;0!=this.currentTags.length?(this.$root.loading=!0,r.post("bookmark/findByTags",e.stringify({tagIds:this.currentTags.join(",")})).then((function(o){o.success?t.bookmarks=o.detail:t.$root.showModal("失败",o.msg)})).catch((function(o){t.$root.showModal("错误",o.message)})).finally((function(){t.$root.loading=!1}))):this.list()}},mounted:function(){this.list(),this.listTags()}},y=function(t){return b("data-v-277ede0b"),t=t(),p(),t},k={class:"mb-2 custom-btn-group"},$=["id","value"],w=["for"],v={class:"input-group mb-2"},M=["disabled"],x=["disabled"],T=["disabled"],C=y((function(){return l("i",{class:"bi bi-three-dots-vertical"},null,-1)})),j={class:"dropdown-menu"},A=y((function(){return l("li",null,[l("a",{class:"dropdown-item",onclick:"document.getElementById('file').value=null; document.getElementById('file').click()"},"导入")],-1)})),B={class:"table table-hover table-borderless border shadow-sm"},S={class:"text-truncate",style:{"max-width":"200px"}},I=["src"],O={key:1,class:"icon",src:"/vite.svg"},U={key:2,class:"align-middle"},E={key:3,class:"align-middle text-muted"},J={class:"text-truncate url",style:{"max-width":"200px"}},N={class:"text-muted"},_={class:"text-end",style:{width:"10%"}},F={class:"dropdown d-inline"},R=y((function(){return l("i",{class:"bi bi-three-dots-vertical link-primary","data-bs-toggle":"dropdown"},null,-1)})),V={class:"dropdown-menu"},D=["href"],L=["data-clipboard-text"],K=y((function(){return l("li",null,[l("hr",{class:"dropdown-divider"})],-1)})),q=["onClick"],z=["onClick"],G=["onClick"];o("default",i(n,[["render",function(t,o,n,i,r,e){var b=this;return h(),a(s,null,[l("input",{type:"file",name:"file",id:"file",class:"d-none",onChange:o[0]||(o[0]=function(t){return e.importBookmarks(t)}),multiple:""},null,32),l("div",k,[(h(!0),a(s,null,u(r.tags,(function(t){return h(),a("div",{key:t,class:"d-inline"},[d(l("input",{type:"checkbox",class:"btn-check",id:t.id,value:t.id,"onUpdate:modelValue":o[1]||(o[1]=function(t){return b.currentTags=t}),autocomplete:"off",onChange:o[2]||(o[2]=function(t){return e.findByTags()})},null,40,$),[[g,b.currentTags]]),l("label",{class:"btn btn-outline-primary",for:t.id},m(t.title),9,w)])})),128))]),l("div",v,[d(l("input",{class:"form-control","onUpdate:modelValue":o[3]||(o[3]=function(t){return r.url=t}),onKeyup:o[4]||(o[4]=f((function(t){return e.add()}),["enter"])),disabled:t.$root.loading},null,40,M),[[c,r.url]]),l("button",{class:"btn btn-outline-primary",onClick:o[5]||(o[5]=function(t){return e.add()}),disabled:t.$root.loading}," 添加 ",8,x),l("button",{class:"btn btn-outline-primary","data-bs-toggle":"dropdown",disabled:t.$root.loading},[C,l("ul",j,[A,l("li",null,[l("a",{class:"dropdown-item",onClick:o[6]||(o[6]=function(t){return e.exportBookmarks()})},"导出")]),l("li",null,[l("a",{class:"dropdown-item",onClick:o[7]||(o[7]=function(t){return e.updateAll()})},"更新")])])],8,T)]),l("table",B,[l("tbody",null,[(h(!0),a(s,null,u(r.bookmarks,(function(o){return h(),a("tr",{key:o},[l("td",S,[o.icon?(h(),a("img",{key:0,class:"icon",src:"data:image/jpeg;base64,"+o.icon},null,8,I)):(h(),a("img",O)),o.title?(h(),a("span",U,m(o.title),1)):(h(),a("span",E,[l("i",null,m(e.extractDomain(o.url)),1)]))]),l("td",J,[l("i",N,m(o.url),1)]),l("td",_,[l("div",F,[R,l("ul",V,[l("li",null,[l("a",{class:"dropdown-item",href:o.url,target:"_blank"},"打开",8,D)]),l("li",null,[l("a",{class:"dropdown-item",id:"btnCopy","data-clipboard-text":o.url},"复制",8,L)]),K,l("li",null,[l("a",{class:"dropdown-item",onClick:function(n){return t.$root.showConfirm((function(){return e.remove(o.id)}))}},"删除",8,q)]),l("li",null,[l("a",{class:"dropdown-item",onClick:function(n){t.$root.inputValue=o.title,t.$root.showInput("修改标题","输入新标题",(function(){e.rename(o.id)}))}},"修改",8,z)]),l("li",null,[l("a",{class:"dropdown-item",onClick:function(t){return e.update(o.id)}},"更新",8,G)])])])])])})),128))])])],64)}],["__scopeId","data-v-277ede0b"]]))}}}))}();
