import{_ as u,a as i,l as c,c as h,b as e,t as d,d as m,o as f,p,i as _}from"./index-754c879a.js";import{Q as b}from"./qrcode-2da1ed4a.js";const g={data(){return{file:""}},methods:{generateCode(){this.$root.$refs.qrcode.innerHTML="",this.$root.src="",new b(this.$root.$refs.qrcode,{text:location.href}),new Modal(this.$root.$refs.imageModal).show()},get(o){this.$root.loading=!0,i.post("/shareCode/get",c.stringify({code:o})).then(t=>{t.success?this.file=t.detail:this.$router.push("/")}).catch(t=>{this.$root.showModal("错误",t.message),this.$router.push("/")}).finally(()=>{this.$root.loading=!1})},download(o){location.href=i.defaults.baseURL+"/file/download?relativePath="+encodeURIComponent(o)},preview(o,t){o.includes("text")?(this.$root.loading=!0,this.$root.message.title=t,this.$root.message.text="",i.post("file/read",c.stringify({relativePath:t})).then(l=>{l.success?(this.$root.message.text=l.detail,new Modal(this.$root.$refs.textModal).show()):this.$root.showModal("失败",l.msg)}).catch(l=>{this.$root.showModal("错误",l.message)}).finally(()=>{this.$root.loading=!1})):o.includes("image")?(this.$root.$refs.qrcode.innerHTML="",this.$root.src="",this.$root.src=i.defaults.baseURL+"file/download?relativePath="+encodeURIComponent(t),new Modal(this.$root.$refs.imageModal).show()):o.includes("video")&&(this.$root.src=i.defaults.baseURL+"file/download?relativePath="+encodeURIComponent(t),new Modal(this.$root.$refs.videoModal).show())}},created(){this.$route.params.code&&this.get(this.$route.params.code)}},r=o=>(p("data-v-411eb037"),o=o(),_(),o),$={class:"card"},v=r(()=>e("div",{class:"card-header"},"文件分享",-1)),w={class:"card-body text-center"},y={class:"table table-borderless table-sm"},M=r(()=>e("td",null,"文件名：",-1)),C=r(()=>e("td",null,"文件大小：",-1)),x=r(()=>e("td",null,"修改时间：",-1)),I=r(()=>e("td",null,"文件类型：",-1));function R(o,t,l,k,s,n){return f(),h("div",$,[v,e("div",w,[e("table",y,[e("tbody",null,[e("tr",null,[M,e("td",null,d(s.file.name),1)]),e("tr",null,[C,e("td",null,d(o.$root.formatBytes(s.file.length)),1)]),e("tr",null,[x,e("td",null,d(s.file.lastModified),1)]),e("tr",null,[I,e("td",null,d(s.file.fileType),1)])])]),e("button",{class:"btn btn-sm btn-outline-primary mt-3",onClick:t[0]||(t[0]=a=>n.download(s.file.relativePath))}," 下载 "),s.file&&(s.file.fileType.includes("image")||s.file.fileType.includes("text")||s.file.fileType.includes("video"))?(f(),h("button",{key:0,class:"btn btn-sm btn-outline-primary mt-3 ms-1",onClick:t[1]||(t[1]=a=>n.preview(s.file.fileType,s.file.relativePath))}," 预览 ")):m("",!0),e("button",{class:"btn btn-sm btn-outline-primary mt-3 ms-1",onClick:t[2]||(t[2]=(...a)=>n.generateCode&&n.generateCode(...a))},"二维码")])])}const L=u(g,[["render",R],["__scopeId","data-v-411eb037"]]);export{L as default};
