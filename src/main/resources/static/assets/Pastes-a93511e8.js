import{_,a as d,l as m,c as a,w as u,v as p,b as e,e as g,F as f,r as v,o as r,i as x,t as n,h as b,d as w}from"./index-51afd596.js";import{h as c}from"./moment-fbc5633a.js";const k={data(){return{pastes:[],title:"",text:""}},methods:{getFromNow(t){return c(t).fromNow()},calcExpiredDate(t){if(t!=0){var s=c(new Date).add(t,"m").toDate();return c(s).format("YYYY-MM-DD HH:mm:ss")}},list(){this.$root.loading=!0,d.post("/paste/list").then(t=>{t.success?this.pastes=t.detail:this.$root.showModal("失败",t.msg)}).catch(t=>{this.$root.showModal("错误",t.message)}).finally(()=>{this.$root.loading=!1})},add(){if(this.text.trim().length===0){this.$root.showModal("提示","正文不能为空");return}this.$root.loading=!0,d.post("/paste/add",m.stringify({title:this.title.trim().length===0?"未命名":this.title,text:this.text,expiredDate:this.calcExpiredDate(this.$refs.select.value),isPrivate:this.$refs.isPrivate.checked})).then(t=>{t.success?(this.list(),this.$root.showModal("发布成功",location.protocol+"//"+location.host+"/pastes/"+t.detail.id),this.text="",this.title=""):this.$root.showModal("失败",t.msg)}).catch(t=>{this.$root.showModal("错误",t.message)}).finally(()=>{this.$root.loading=!1})},remove(t){this.$root.hasToken(()=>this.remove(t))&&(this.$root.loading=!0,d.post("/paste/delete",m.stringify({id:t})).then(s=>{s.success?(this.$root.showModal("成功","删除成功"),this.list()):this.$root.showModal("失败",s.msg)}).catch(s=>{this.$root.showModal("错误",s.message)}).finally(()=>{this.$root.loading=!1}))}},created(){this.list()}},$={class:"float-end mb-3 row g-3 align-middle"},y={class:"col-auto"},M={class:"form-check form-switch",style:{padding:"0.375rem 0.75rem"}},D={class:"form-check-input",type:"checkbox",role:"switch",id:"isPrivate",ref:"isPrivate"},C=e("label",{class:"form-check-label",for:"isPrivate"},"私密",-1),N={class:"col-auto"},P={class:"form-select mb-2",ref:"select"},T=["selected"],V=e("option",{value:"60"},"1小时",-1),E=e("option",{value:"1440"},"1天",-1),F=e("option",{value:"10080"},"1周",-1),Y=["selected"],B={class:"col-auto"},H={class:"list-group clear-both"},K=["onClick"],U={class:"float-end"},j=["data-clipboard-text"],z=["onClick"],A={class:"text-primary text-truncate mw-75"},L={class:"text-truncate mw-75"},O={class:"text-muted mb-0"},S={key:0,class:"text-danger",style:{"font-size":"0.875rem"}};function q(t,s,G,I,i,l){return r(),a(f,null,[u(e("input",{class:"form-control mb-2",placeholder:"标题","onUpdate:modelValue":s[0]||(s[0]=o=>i.title=o)},null,512),[[p,i.title]]),u(e("textarea",{class:"form-control mb-3",rows:"10",placeholder:"正文","onUpdate:modelValue":s[1]||(s[1]=o=>i.text=o),onKeyup:s[2]||(s[2]=g(x(o=>l.add(),["ctrl"]),["enter"]))},null,544),[[p,i.text]]),e("div",$,[e("div",y,[e("div",M,[e("input",D,null,512),C])]),e("div",N,[e("select",P,[e("option",{value:"10",selected:t.$root.noToken()},"10分钟",8,T),V,E,F,e("option",{value:"0",selected:!t.$root.noToken()},"永不过期",8,Y)],512)]),e("div",B,[e("button",{class:"btn btn-outline-primary mb-2 col-auto",onClick:s[3]||(s[3]=o=>l.add())},"发布")])]),e("ul",H,[(r(!0),a(f,null,v(i.pastes,o=>(r(),a("li",{class:"list-group-item list-group-item-action cursor-pointer",key:o,onClick:h=>h.target.tagName!=="A"&&t.$router.push("/pastes/"+o.id)},[e("div",U,[e("a",{class:"link-primary bi bi-clipboard",id:"btnCopy","data-clipboard-text":o.text},null,8,j),e("a",{class:"link-danger bi bi-trash ms-1",onClick:h=>t.$root.showConfirm(()=>l.remove(o.id))},null,8,z)]),e("div",null,[e("p",A,n(o.title),1),e("p",L,n(o.text),1),e("p",O,[b("发布于 "+n(o.time.slice(0,-3)),1),o.expiredDate?(r(),a("span",S,"  Expired "+n(l.getFromNow(o.expiredDate)),1)):w("",!0)])])],8,K))),128))])],64)}const R=_(k,[["render",q]]);export{R as default};
